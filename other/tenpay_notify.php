<?php global $zym_decrypt;$zym_decrypt['Ž¯¯”‹¯¯¾®¥Ã”®ÄýÁ¥¯”Ãˆ¥ŽÃ‹Ž”®¯¾ˆ®']=base64_decode('aGVhZGVy');$zym_decrypt['ýÁŽˆý”ÖýÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯ÃŽ']=base64_decode('c3RydG90aW1l');$zym_decrypt['ŽÁýýÃ¯¥‹¯‹®”ýÃ®ÃÁÄŽ”ÀŽÖ‹Ã¯ÖÖý¥Ö‹']=base64_decode('dGltZQ==');$zym_decrypt['ˆ¾ÖÄÖ”¯ÄÄ‹¥ÃÃÄÃÖýˆ¥Ä”ˆÄ®ÁÄ®‹”Ž®ˆ']=base64_decode('Z2V0c2hvcA=='); ?>
<?php
 $mod='blank';$nosecu=true;require_once(base64_decode('Li4vaW5jbHVkZXMvY29tbW9uLnBocA=='));require (SYSTEM_ROOT.base64_decode('dGVucGF5L1Jlc3BvbnNlSGFuZGxlci5jbGFzcy5waHA='));require (SYSTEM_ROOT.base64_decode('dGVucGF5L1JlcXVlc3RIYW5kbGVyLmNsYXNzLnBocA=='));require (SYSTEM_ROOT.base64_decode('dGVucGF5L2NsaWVudC9DbGllbnRSZXNwb25zZUhhbmRsZXIuY2xhc3MucGhw'));require (SYSTEM_ROOT.base64_decode('dGVucGF5L2NsaWVudC9UZW5wYXlIdHRwQ2xpZW50LmNsYXNzLnBocA=='));require (SYSTEM_ROOT.base64_decode('dGVucGF5L2Z1bmN0aW9uLnBocA=='));@$GLOBALS['zym_decrypt']['Ž¯¯”‹¯¯¾®¥Ã”®ÄýÁ¥¯”Ãˆ¥ŽÃ‹Ž”®¯¾ˆ®'](base64_decode('Q29udGVudC1UeXBlOiB0ZXh0L2h0bWw7IGNoYXJzZXQ9VVRGLTg='));$resHandler =new ResponseHandler();$resHandler->setKey($key);if($resHandler->isTenpaySign()){$notify_id =$resHandler->getParameter("notify_id");$queryReq =new RequestHandler();$queryReq->init();$queryReq->setKey($key);$queryReq->setGateUrl("https://gw.tenpay.com/gateway/simpleverifynotifyid.xml");$queryReq->setParameter("partner", $conf['tenpay_pid']);$queryReq->setParameter("notify_id", $notify_id);$httpClient =new TenpayHttpClient();$httpClient->setTimeOut(5);$httpClient->setReqContent($queryReq->getRequestURL());if($httpClient->call()){$queryRes =new ClientResponseHandler();$queryRes->setContent($httpClient->getResContent());$queryRes->setKey($conf['tenpay_key']);if($queryRes->isTenpaySign()&& $queryRes->getParameter("retcode")== "0" && $resHandler->getParameter("trade_state")== "0"){log_result("å³æ—¶åˆ°å¸éªŒç­¾IDæˆåŠŸ");$out_trade_no =$resHandler->getParameter("out_trade_no");$transaction_id =$resHandler->getParameter("transaction_id");$total_fee =$resHandler->getParameter("total_fee");$discount =$resHandler->getParameter("discount");$srow=$DB->get_row("SELECT * FROM ".DBQZ."_pay WHERE orderid='{$out_trade_no}' limit 1");$uid=$srow['uid'];$sql="insert into `".DBQZ."_order` (`type`,`orderid`,`trade_no`,`time`,`name`,`money`,`status`) values ('tenpay','".$out_trade_no."','".$transaction_id."','".$date."','".$srow['name']."','".$srow['money']."','2')";$DB->query($sql);if($srow['status']==0){$DB->query("update `".DBQZ."_pay` set `status` ='1',`endtime` ='$date' where `orderid`='$out_trade_no'");$msg ='OK';$row=$DB->get_row("select userid,coin,vip,vipdate from ".DBQZ."_user where userid='".$uid."' limit 1");if($row['vip']==1 && $GLOBALS['zym_decrypt']['ýÁŽˆý”ÖýÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯ÃŽ']($row['vipdate'])>$GLOBALS['zym_decrypt']['ŽÁýýÃ¯¥‹¯‹®”ýÃ®ÃÁÄŽ”ÀŽÖ‹Ã¯ÖÖý¥Ö‹']()|| $row['vip']==2){$isvip=1;}else{$isvip=0;}$GLOBALS['zym_decrypt']['ˆ¾ÖÄÖ”¯ÄÄ‹¥ÃÃÄÃÖýˆ¥Ä”ˆÄ®ÁÄ®‹”Ž®ˆ']($srow['shopid'],$srow['qq'],$msg);}echo base64_decode('c3VjY2Vzcw==');}else {echo base64_decode('ZmFpbA==');}}else{echo base64_decode('ZmFpbA==');echo base64_decode('PGJyPmNhbGwgZXJyOg==') . $httpClient->getResponseCode()."," . $httpClient->getErrInfo(). "<br>";}}else {echo base64_decode('PGJyLz4=') . base64_decode('6K6k6K+B562+5ZCN5aSx6LSl') . base64_decode('PGJyLz4=');echo $resHandler->getDebugInfo(). "<br>";}?>